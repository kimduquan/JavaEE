# tag::system[]
apiVersion: apps.openliberty.io/v1beta2
# tag::olapp[]
kind: OpenLibertyApplication
# end::olapp[]
metadata:
  name: openup
  labels:
    name: openup
spec:
  # tag::sysImage[]
  applicationImage: openup:1.0.0
  # end::sysImage[]
  # tag::service[]
  service:
    # tag::servicePort[]
    port: 9080
    # end::servicePort[]
  # end::service[]
  # tag::expose[]
  expose: true
  # end::expose[]
  route:
    pathType: ImplementationSpecific
  # tag::systemEnv[]
  env:
    - name: WLP_LOGGING_MESSAGE_FORMAT
      value: "json"
    - name: WLP_LOGGING_MESSAGE_SOURCE
      value: "message,trace,accessLog,ffdc,audit"
  # end::systemEnv[]
  # tag::healthProbes[]
  # tag::startupProbe[]
  probes:
    startup:
      failureThreshold: 12
      httpGet:
        path: /health/ready
        port: 9080
        scheme: HTTP
      initialDelaySeconds: 60
      periodSeconds: 60
      timeoutSeconds: 10
  # end::startupProbe[]
  # tag::livenessProbe[]
    liveness:
      failureThreshold: 12
      httpGet:
        path: /health/live
        port: 9080
        scheme: HTTP
      initialDelaySeconds: 60
      periodSeconds: 60
      timeoutSeconds: 10
  # end::livenessProbe[]
  # tag::readinessProbe[]
    readiness:
      failureThreshold: 12
      httpGet:
        path: /health/ready
        port: 9080
        scheme: HTTP
      initialDelaySeconds: 60
      periodSeconds: 60
      timeoutSeconds: 10
  # end::readinessProbe[]
  # end::healthProbes[]
# end::system[]
