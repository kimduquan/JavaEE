<html xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:a="http://xmlns.jcp.org/jsf/passthrough" xmlns:jsf="http://xmlns.jcp.org/jsf" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:p="http://primefaces.org/ui">
<ui:composition template="../template/blank.xhtml">
<ui:define name="title">Tables</ui:define>
<ui:define name="head">
    <!-- Custom styles for this page -->
    <link type="text/css" rel="stylesheet" href="/webapp/resources/startbootstrap-sb-admin-2-gh-pages/vendor/datatables/dataTables.bootstrap4.min.css" />
	<f:metadata><f:viewParam name="schema" value="#{epf_query_view.schema}" /><f:viewParam name="entity" value="#{epf_query_view.entity}" /></f:metadata>
</ui:define>
					<ui:define name="page-content">
                    <!-- Page Heading -->
                    <h1 class="h3 mb-2 text-gray-800">Tables</h1>
                    <p class="mb-4">DataTables is a third party plugin that is used to generate the demo table below.
                        For more information about DataTables, please visit the <a target="_blank"
                            href="https://datatables.net">official DataTables documentation</a>.</p>

                    <!-- DataTales Example -->
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">DataTables Example</h6>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <h:form id="query">
                                	<p:toolbar>
							            <p:toolbarGroup>
							                <p:commandButton value="#{i18n['epf.persistence.persist']}" actionListener="#{epf_persistence_view.prePersist}" update=":persistence:attributes" oncomplete="PF('persistenceDialog').show()" styleClass="ui-button-info" icon="pi pi-plus">
							                    <p:resetInput target=":persistence:attributes" />
							                </p:commandButton>
							                <p:commandButton id="remove-entity" value="#{i18n['epf.persistence.remove']}" actionListener="#{epf_query_view.remove}" update="@this" styleClass="ui-button-danger" icon="pi pi-trash">
							                    <p:confirm header="Confirmation" message="Delete the selected rows?" />
							                </p:commandButton>
							            </p:toolbarGroup>
							        </p:toolbar>
							        <p:contextMenu for="dataTable">
							        </p:contextMenu>
							        <p:dataTable value="#{epf_query_view.collector}" lazy="true" var="entityValue" tableStyleClass="table table-bordered" id="dataTable" widgetVar="dataTable" tableStyle="width: 100%;" paginator="true" rows="10" editable="true" selection="#{epf_persistence_view.entities}" rowSelectMode="add" showGridlines="true" draggableColumns="true" draggableRows="true" resizableColumns="true" scrollable="true" selectionMode="multiple" allowUnsorting="true" sortMode="multiple" currentPageReportTemplate="Showing {startRecord} to {endRecord} of {totalRecords} entries" rowsPerPageTemplate="10,25,50,100" paginatorTemplate="{CurrentPageReport} {PreviousPageLink} {PageLinks} {NextPageLink} Show {RowsPerPageDropdown} entries">
	                                    <f:facet name="header">
	                                    	<h:outputText value="#{i18n['epf.persistence.query.search']}" />:
							                <p:inputText id="globalFilter" onkeyup="PF('dataTable').filter()" />
							            </f:facet>
	                                    <p:columns value="#{epf_query_view.attributes}" var="attribute" columnIndexVar="attributeIndex" field="#{attribute.name}" sortPriority="#{attributeIndex}">
								            <f:facet name="header">
								                <h:outputText value="#{attribute.name}" />
								            </f:facet>
								            <f:facet name="footer">
								                <h:outputText value="#{attribute.name}" />
								            </f:facet>
								            <h:outputText value="#{epf_query_view.getAttribute(entityValue, attribute.name)}" />
								        </p:columns>
								        <p:column exportable="false">
							                <p:commandButton update=":persistence:attributes" oncomplete="PF('persistenceDialog').show()" process="@this" styleClass="ui-button-info" icon="pi pi-pencil">
							                	<f:setPropertyActionListener value="#{entityValue}" target="#{epf_persistence_view.entity}" />
							                    <p:resetInput target=":persistence:attributes" />
							                </p:commandButton>
							                <p:commandButton process="@this" oncomplete="PF('removeDialog').show()" styleClass="ui-button-danger" icon="pi pi-trash">
							                	<f:setPropertyActionListener value="#{entityValue}" target="#{epf_persistence_view.entity}" />
							                </p:commandButton>
							            </p:column>
								        <f:facet name="emptyMessage">
								        	<h:outputText value="#{i18n['epf.persistence.query.resultList.empty']}" />
								        </f:facet>
								        <p:ajax event="rowSelect" update=":query:remove-entity" />
							            <p:ajax event="rowUnselect" update=":query:remove-entity" />
							            <p:ajax event="rowSelectCheckbox" update=":query:remove-entity" />
							            <p:ajax event="rowUnselectCheckbox" update=":query:remove-entity" />
							            <p:ajax event="toggleSelect" update=":query:remove-entity" />
	                                </p:dataTable>
                                </h:form>
                            	<h:form id="persistence">
                            		<p:dialog showEffect="fade" modal="true" widgetVar="persistenceDialog" responsive="true">
                            			<p:outputPanel id="attributes">
                            				<p:outputPanel rendered="#{not empty epf_persistence_view.entity}">
                            				</p:outputPanel>
                            			</p:outputPanel>
                            			<f:facet name="footer">
							                <p:commandButton value="Save" actionListener="#{epf_persistence_view.merge}" update="attributes" process="attributes @this" />
							                <p:commandButton value="Cancel" onclick="PF('persistenceDialog').hide()" type="button" />
							            </f:facet>
            						</p:dialog>
            						<p:confirmDialog widgetVar="removeDialog" showEffect="fade" message="Delete the row?" header="Confirm" severity="warn">
							            <p:commandButton value="Yes" actionListener="#{epf_persistence_view.remove}" process="@this" update=":query:remove-entity" oncomplete="PF('removeDialog').hide()" />
							            <p:commandButton value="No" type="button" onclick="PF('removeDialog').hide()" />
							        </p:confirmDialog>
                            	</h:form>
                            </div>
                        </div>
                    </div>
					</ui:define>
	<ui:define name="script">
    <!-- Page level plugins -->
    <script type="text/javascript" src="/webapp/resources/startbootstrap-sb-admin-2-gh-pages/vendor/datatables/jquery.dataTables.min.js" />
    <script type="text/javascript" src="/webapp/resources/startbootstrap-sb-admin-2-gh-pages/vendor/datatables/dataTables.bootstrap4.min.js" />

    <!-- Page level custom scripts -->
    <script type="text/javascript" src="/webapp/resources/startbootstrap-sb-admin-2-gh-pages/js/demo/datatables-demo.js" />
	</ui:define>
</ui:composition>
</html>